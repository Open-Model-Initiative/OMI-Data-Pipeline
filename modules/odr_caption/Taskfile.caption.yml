version: '3'

tasks:
  outlines:
    cmds:
      - pip install git+https://github.com/dottxt-ai/outlines --upgrade
  install:
    cmds:
      - pip install -e ./modules/odr_caption
      - pip install -r ./modules/odr_caption/requirements.txt
      - pip install flash-attn --no-build-isolation
      - task caption:outlines
      # - task caption:transformers

  build:
    cmds:
      - docker compose -f ./modules/odr_caption/docker/caption.docker-compose.yml build

  run:
    cmds:
      - docker compose -f ./modules/odr_caption/docker/caption.docker-compose.yml up

  stop:
    cmds:
      - docker compose -f ./modules/odr_caption/docker/caption.docker-compose.yml down
